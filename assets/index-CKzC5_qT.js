import{u as T,r as C,o as q,a as L,b as n,c as l,d as s,e as b,w as k,f as N,g as m,h as p,t as d,i as f,j as h,v as V,F as v,k as y,n as x,l as w,m as g,p as $,q as E,s as R,x as K}from"./vendor-BaeeyaPf.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))u(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const e of o.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&u(e)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();const O="/Project_KiNangLamViec/assets/logo2-Djjch0Yn.png",_=(i,t)=>{const a=i.__vccOpts||i;for(const[u,r]of t)a[u]=r;return a},Q={class:"navbar navbar-expand-lg navbar-dark bg-dark shadow"},B={class:"container-fluid"},J=["src"],j={class:"collapse navbar-collapse",id:"navbarNav"},X={class:"navbar-nav ms-auto"},H={key:0},G={key:1},z={key:2},Y={class:"nav-item"},W={class:"nav-item dropdown"},Z={class:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},tt={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"navbarDropdown"},st={key:0},et={key:1},rt={key:2},it={key:3},ot={key:4},nt={__name:"nav",setup(i){const t=T(),a=C(null);function u(){sessionStorage.removeItem("user"),sessionStorage.removeItem("isAuthenticated"),t.push("/login"),r()}q(()=>{const o=sessionStorage.getItem("user");o?a.value=JSON.parse(o):a.value=null});function r(){window.location.href="/"}return(o,e)=>{var A,M,I,S;const c=L("router-link");return n(),l("nav",Q,[s("div",B,[b(c,{to:"/",class:"navbar-brand",onClick:r},{default:k(()=>[s("img",{alt:"Logo",src:N(O)},null,8,J)]),_:1}),e[12]||(e[12]=s("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[s("span",{class:"navbar-toggler-icon"})],-1)),s("div",j,[s("ul",X,[(A=a.value)!=null&&A.isAdmin?(n(),l("li",H,[b(c,{to:"/admin/users",class:"nav-link"},{default:k(()=>e[0]||(e[0]=[s("i",{class:"fas fa-edit me-2"},null,-1),m("Quản Lí Users ")])),_:1})])):p("",!0),(M=a.value)!=null&&M.isAdmin?(n(),l("li",G,[b(c,{to:"/admin/videos",class:"nav-link"},{default:k(()=>e[1]||(e[1]=[s("i",{class:"fas fa-edit me-2"},null,-1),m("Quản Lí Videos ")])),_:1})])):p("",!0),(I=a.value)!=null&&I.isAdmin?(n(),l("li",z,[b(c,{to:"/admin/reports",class:"nav-link"},{default:k(()=>e[2]||(e[2]=[s("i",{class:"fas fa-edit me-2"},null,-1),m("Quản Lí Report ")])),_:1})])):p("",!0),s("li",Y,[b(c,{to:"/favorites",class:"nav-link"},{default:k(()=>e[3]||(e[3]=[s("i",{class:"fas fa-heart me-2"},null,-1),m("Yêu thích ")])),_:1})]),s("li",W,[s("a",Z,[e[4]||(e[4]=s("i",{class:"fas fa-user-circle me-2"},null,-1)),e[5]||(e[5]=m(" Chào, ")),s("b",null,d(((S=a.value)==null?void 0:S.fullname)||"Tài khoản"),1)]),s("ul",tt,[a.value?p("",!0):(n(),l("li",st,[b(c,{to:"/login",class:"dropdown-item"},{default:k(()=>e[6]||(e[6]=[s("i",{class:"fas fa-sign-in-alt me-2"},null,-1),m("Đăng nhập ")])),_:1})])),a.value?p("",!0):(n(),l("li",et,[b(c,{to:"/sign_up",class:"dropdown-item"},{default:k(()=>e[7]||(e[7]=[s("i",{class:"fas fa-user-plus me-2"},null,-1),m("Đăng ký ")])),_:1})])),a.value?(n(),l("li",rt,[b(c,{to:"/edit-profile",class:"dropdown-item"},{default:k(()=>e[8]||(e[8]=[s("i",{class:"fas fa-edit me-2"},null,-1),m("Chỉnh sửa thông tin ")])),_:1})])):p("",!0),a.value?(n(),l("li",it,[b(c,{to:"/change-password",class:"dropdown-item"},{default:k(()=>e[9]||(e[9]=[s("i",{class:"fas fa-lock me-2"},null,-1),m("Đổi mật khẩu ")])),_:1})])):p("",!0),e[11]||(e[11]=s("li",null,[s("hr",{class:"dropdown-divider"})],-1)),a.value?(n(),l("li",ot,[s("button",{class:"dropdown-item",onClick:u},e[10]||(e[10]=[s("i",{class:"fas fa-sign-out-alt me-2"},null,-1),m("Đăng xuất ")]))])):p("",!0)])])])])])])}}},lt=_(nt,[["__scopeId","data-v-4cdfcb7b"]]),at={class:"main-container"},dt={class:"content"},ut={__name:"App",setup(i){return(t,a)=>{const u=L("router-view");return n(),l("div",at,[b(lt),a[0]||(a[0]=s("div",{class:"banner text-center"},[s("h1",null,"Danh Sách Quán Ăn Ngon"),s("p",{class:"subtitle"}," Tìm kiếm và khám phá những quán ăn ngon nhất quanh bạn. ")],-1)),s("div",dt,[b(u)])])}}},ct=_(ut,[["__scopeId","data-v-9dc84c02"]]),mt={data(){return{items:[],provinces:[],selectedProvince:"",isLoading:!1,currentPage:1,itemsPerPage:9}},computed:{totalPages(){return Math.ceil(this.filteredItems.length/this.itemsPerPage)},paginatedItems(){const i=(this.currentPage-1)*this.itemsPerPage,t=i+this.itemsPerPage;return this.filteredItems.slice(i,t)},filteredItems(){return this.selectedProvince?this.items.filter(i=>i.province===this.selectedProvince):this.items}},methods:{async fetchItems(){this.isLoading=!0;try{const i=await f.get("http://localhost:8080/ASM_KiNangLamViec/listQuanAn_api");i.status===200&&(this.items=i.data.map(t=>({id:t.id,name:t.name,address:t.address,province:t.province,type:t.type,averagePrice:t.averagePrice,rating:t.rating})),this.provinces=[...new Set(this.items.map(t=>t.province))])}catch(i){console.error("Error fetching data:",i)}finally{this.isLoading=!1}},filterByProvince(){this.currentPage=1},viewDetails(i){this.$router.push({name:"QuanAnDetails",params:{id:i}})},goToFirstPage(){this.currentPage=1},goToPreviousPage(){this.currentPage>1&&(this.currentPage-=1)},goToNextPage(){this.currentPage<this.totalPages&&(this.currentPage+=1)},goToLastPage(){this.currentPage=this.totalPages},formatCurrency(i){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(i)}},mounted(){this.fetchItems()}},ht={class:"mb-4"},pt=["value"],gt={key:0,id:"loader",class:"text-center my-5"},ft={key:1,class:"row"},bt={key:0,class:"text-center"},vt={class:"card"},yt={class:"card-body"},_t={class:"card-title"},kt={class:"card-text"},wt={class:"card-text"},Pt={class:"card-text"},xt={class:"card-text"},Lt={class:"card-text"},Ft=["onClick"],Vt={class:"pagination text-center mt-4 mb-4"},At=["disabled"],Mt=["disabled"],It=["onClick"],St=["disabled"],Dt=["disabled"];function $t(i,t,a,u,r,o){return n(),l("div",null,[t[19]||(t[19]=s("h1",{class:"mb-4 mt-5"},"Danh Sách Quán Ăn",-1)),s("div",ht,[t[7]||(t[7]=s("label",{for:"province"},"Chọn Tỉnh/Thành phố:",-1)),h(s("select",{id:"province","onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedProvince=e),class:"form-select",onChange:t[1]||(t[1]=(...e)=>o.filterByProvince&&o.filterByProvince(...e))},[t[6]||(t[6]=s("option",{value:""},"Tất cả",-1)),(n(!0),l(v,null,y(r.provinces,e=>(n(),l("option",{key:e,value:e},d(e),9,pt))),128))],544),[[V,r.selectedProvince]])]),r.isLoading?(n(),l("div",gt,t[8]||(t[8]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)]))):(n(),l("div",ft,[o.paginatedItems.length===0?(n(),l("div",bt,t[9]||(t[9]=[s("p",{class:"text-muted"},"Không có dữ liệu",-1)]))):p("",!0),(n(!0),l(v,null,y(o.paginatedItems,e=>(n(),l("div",{class:"col-md-4 mb-5",key:e.id},[s("div",vt,[s("div",yt,[s("h5",_t,d(e.name),1),s("p",kt,[t[10]||(t[10]=s("b",null,"Địa chỉ:",-1)),m(" "+d(e.address),1)]),s("p",wt,[t[11]||(t[11]=s("b",null,"Tỉnh/Thành phố:",-1)),m(" "+d(e.province),1)]),s("p",Pt,[t[12]||(t[12]=s("b",null,"Loại quán:",-1)),m(" "+d(e.type),1)]),s("p",xt,[t[13]||(t[13]=s("b",null,"Giá trung bình:",-1)),m(" "+d(o.formatCurrency(e.averagePrice)),1)]),s("p",Lt,[t[14]||(t[14]=s("b",null,"Đánh giá:",-1)),m(" "+d(e.rating)+" ⭐",1)]),s("button",{class:"btn btn-primary",onClick:c=>o.viewDetails(e.id)},"Chi tiết",8,Ft)])])]))),128))])),s("div",Vt,[s("button",{class:"btn btn-secondary",disabled:r.currentPage===1,onClick:t[2]||(t[2]=(...e)=>o.goToFirstPage&&o.goToFirstPage(...e))},t[15]||(t[15]=[s("i",{class:"fa-solid fa-backward-step"},null,-1)]),8,At),s("button",{class:"btn btn-secondary mx-2",disabled:r.currentPage===1,onClick:t[3]||(t[3]=(...e)=>o.goToPreviousPage&&o.goToPreviousPage(...e))},t[16]||(t[16]=[s("i",{class:"fa-solid fa-backward"},null,-1)]),8,Mt),(n(!0),l(v,null,y(o.totalPages,e=>(n(),l("button",{key:e,class:x(["btn",e===r.currentPage?"btn-primary":"btn-secondary"]),onClick:c=>r.currentPage=e},d(e),11,It))),128)),s("button",{class:"btn btn-secondary mx-2",disabled:r.currentPage===o.totalPages,onClick:t[4]||(t[4]=(...e)=>o.goToNextPage&&o.goToNextPage(...e))},t[17]||(t[17]=[s("i",{class:"fa-solid fa-forward"},null,-1)]),8,St),s("button",{class:"btn btn-secondary",disabled:r.currentPage===o.totalPages,onClick:t[5]||(t[5]=(...e)=>o.goToLastPage&&o.goToLastPage(...e))},t[18]||(t[18]=[s("i",{class:"fa-solid fa-forward-step"},null,-1)]),8,Dt)])])}const Ut=_(mt,[["render",$t],["__scopeId","data-v-781515fa"]]),Tt={data(){return{quanAn:{},relatedQuanAns:[],isLoading:!1}},methods:{async fetchQuanAn(){this.isLoading=!0;try{const i=this.$route.params.id;if(!i){alert("Không tìm thấy quán ăn."),this.$router.push("/");return}const t=await f.get(`http://localhost:8080/ASM_KiNangLamViec/listQuanAn_api/${i}`);t.status===200?(this.quanAn=t.data,this.fetchRelatedQuanAns()):(alert("Không thể tải chi tiết quán ăn."),this.$router.push("/"))}catch(i){console.error("Lỗi khi gọi API:",i),alert("Không thể tải quán ăn. Vui lòng thử lại sau."),this.$router.push("/")}finally{this.isLoading=!1}},async fetchRelatedQuanAns(){try{const i=await f.get("http://localhost:8080/ASM_KiNangLamViec/listQuanAn_api");i.status===200?this.relatedQuanAns=i.data.filter(t=>t.province===this.quanAn.province&&t.id!==this.quanAn.id):console.warn("Không thể tải danh sách quán ăn liên quan.")}catch(i){console.error("Lỗi khi gọi API quán ăn liên quan:",i)}},goToQuanAn(i){this.$router.push({name:"QuanAnDetails",params:{id:i}}).then(()=>{window.location.reload()})},likeQuanAn(){alert("Bạn đã thích quán ăn này!")},shareQuanAn(){alert("Link chia sẻ quán ăn đã được sao chép!")}},mounted(){this.fetchQuanAn()}},Ct={key:0,id:"loader",class:"text-center my-5"},qt={key:1},Nt={class:"row mt-5"},Et={class:"col-md-9 mb-5"},Rt={class:"card shadow-sm"},Kt={class:"card-body"},Ot={class:"card-title"},Qt={class:"card-text"},Bt={class:"card-text"},Jt=["href"],jt={class:"card-text"},Xt={class:"card-text"},Ht={class:"card-text"},Gt={class:"card-text"},zt={class:"card-text"},Yt={class:"col-md-3 mb-5"},Wt={class:"card-body"},Zt={class:"card-title"},ts={class:"card-text"},ss=["onClick"];function es(i,t,a,u,r,o){return n(),l("div",null,[r.isLoading?(n(),l("div",Ct,t[2]||(t[2]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Đang tải...")],-1)]))):(n(),l("div",qt,[s("div",Nt,[s("div",Et,[s("div",Rt,[s("div",Kt,[s("h5",Ot,d(r.quanAn.name),1),s("p",Qt,"Địa chỉ: "+d(r.quanAn.address),1),s("p",Bt,[t[3]||(t[3]=m("Google Map Link: ")),s("a",{href:r.quanAn.googleMapLink,target:"_blank",rel:"noopener noreferrer",class:"text-primary"}," Xem trên Google Maps ",8,Jt)]),s("p",jt,"Tỉnh/Thành phố: "+d(r.quanAn.province),1),s("p",Xt,"Loại quán: "+d(r.quanAn.type),1),s("p",Ht,"Giá trung bình: "+d(r.quanAn.averagePrice)+" VND",1),s("p",Gt,"Đánh giá: "+d(r.quanAn.rating)+" ⭐",1),s("p",zt,"Mô tả: "+d(r.quanAn.description),1),s("button",{class:"btn btn-outline-success me-2",onClick:t[0]||(t[0]=(...e)=>o.likeQuanAn&&o.likeQuanAn(...e))},t[4]||(t[4]=[s("i",{class:"fas fa-thumbs-up"},null,-1),m(" Thích ")])),s("button",{class:"btn btn-outline-info",onClick:t[1]||(t[1]=(...e)=>o.shareQuanAn&&o.shareQuanAn(...e))},t[5]||(t[5]=[s("i",{class:"fas fa-share"},null,-1),m(" Chia sẻ ")]))])])]),s("div",Yt,[t[6]||(t[6]=s("h5",{class:"mb-3"},"Quán ăn liên quan",-1)),(n(!0),l(v,null,y(r.relatedQuanAns,e=>(n(),l("div",{key:e.id,class:"card card1 shadow-sm mb-3"},[s("div",Wt,[s("h6",Zt,d(e.name),1),s("p",ts,"Địa chỉ: "+d(e.address),1),s("button",{class:"btn btn-outline-primary btn-sm",onClick:c=>o.goToQuanAn(e.id)}," Xem ngay ",8,ss)])]))),128))])])]))])}const rs=_(Tt,[["render",es],["__scopeId","data-v-b503936a"]]),is={data(){return{items:[],likedVideos:[],isLoading:!1,currentPage:1,itemsPerPage:6}},computed:{totalPages(){return Math.ceil(this.items.length/this.itemsPerPage)},paginatedItems(){const i=(this.currentPage-1)*this.itemsPerPage,t=i+this.itemsPerPage;return this.items.slice(i,t)}},methods:{async fetchItems(){this.isLoading=!0;const i=sessionStorage.getItem("user")?JSON.parse(sessionStorage.getItem("user")).id:null;try{const t=await f.get(`http://localhost:8082/ASM_Java4/like_api?userId=${i}`);t.status===200&&(this.items=t.data,await this.fetchLikedVideos())}catch(t){console.error("Error fetching data:",t)}finally{this.isLoading=!1}},async fetchLikedVideos(){const i=sessionStorage.getItem("user")?JSON.parse(sessionStorage.getItem("user")).id:null;if(i)try{const t=await f.get(`http://localhost:8082/ASM_Java4/like_api?userId=${i}`);t.status===200&&(this.likedVideos=t.data.map(a=>a.videoId))}catch(t){console.error("Error fetching liked videos:",t)}},async toggleLike(i){const t=sessionStorage.getItem("user")?JSON.parse(sessionStorage.getItem("user")).id:null;if(!t){alert("Bạn cần đăng nhập để sử dụng chức năng này!"),this.$router.push("/login");return}if(this.likedVideos.includes(i))try{(await f.delete("http://localhost:8082/ASM_Java4/like_api/",{data:{userId:t,videoId:i}})).status===200?(this.likedVideos=this.likedVideos.filter(u=>u!==i),await this.fetchLikedVideos()):alert("Đã có lỗi xảy ra. Vui lòng thử lại sau.")}catch(a){console.error("Lỗi khi xóa thích video:",a),alert("Không thể bỏ thích video. Vui lòng thử lại sau.")}else try{const a=await f.post("http://localhost:8082/ASM_Java4/like_api/",{userId:t,videoId:i});if(a.status===201){const u=a.data;u&&this.likedVideos.push(u.videoId),alert("Đã thích video thành công!"),await this.fetchLikedVideos()}else alert("Đã có lỗi xảy ra. Vui lòng thử lại sau.")}catch(a){console.error("Lỗi khi thực hiện thích video:",a),alert("Không thể thích video. Vui lòng thử lại sau.")}},viewDetails(i){this.$router.push({name:"VideoDetails",params:{id:i}})},getImagePath(i){return i?`/img/${i}`:"/img/default-poster.jpg"},goToFirstPage(){this.currentPage=1},goToPreviousPage(){this.currentPage>1&&(this.currentPage-=1)},goToNextPage(){this.currentPage<this.totalPages&&(this.currentPage+=1)},goToLastPage(){this.currentPage=this.totalPages}},mounted(){this.fetchItems()}},os={key:0,id:"loader",class:"text-center my-5"},ns={key:1,class:"row"},ls={key:0,class:"text-center"},as={class:"card"},ds=["src","alt"],us={class:"card-body"},cs={class:"card-title"},ms={class:"card-text"},hs={class:"luot-xem"},ps=["onClick"],gs=["onClick"],fs={class:"pagination text-center mt-4 mb-4"},bs=["disabled"],vs=["disabled"],ys=["onClick"],_s=["disabled"],ks=["disabled"];function ws(i,t,a,u,r,o){return n(),l("div",null,[t[12]||(t[12]=s("h1",{class:"mb-4 mt-5"},"Danh Sách Video",-1)),r.isLoading?(n(),l("div",os,t[4]||(t[4]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)]))):(n(),l("div",ns,[o.paginatedItems.length===0?(n(),l("div",ls,t[5]||(t[5]=[s("p",{class:"text-muted"},"Không có dữ liệu",-1)]))):p("",!0),(n(!0),l(v,null,y(o.paginatedItems,e=>(n(),l("div",{class:"col-md-4 mb-5",key:e.id},[s("div",as,[s("img",{src:e.poster?o.getImagePath(e.poster):"",class:"card-img-top mx-auto d-block m-3",alt:e.title,loading:"lazy"},null,8,ds),s("div",us,[s("h5",cs,d(e.title),1),s("p",ms,[t[6]||(t[6]=m("Lượt xem: ")),s("span",hs,d(e.views),1)]),s("button",{class:"btn btn-primary",onClick:c=>o.viewDetails(e.id)},"Chi tiết",8,ps),s("button",{class:x(["btn m-2",r.likedVideos.includes(e.id)?"btn-danger":"btn-outline-success"]),onClick:c=>o.toggleLike(e.id)},[s("i",{class:x(["fas",r.likedVideos.includes(e.id)?"fa-thumbs-down":"fa-thumbs-up"])},null,2),m(" "+d(r.likedVideos.includes(e.id)?"Bỏ thích":"Thích"),1)],10,gs),t[7]||(t[7]=s("button",{class:"btn btn-outline-info"},[s("i",{class:"fas fa-share"}),m(" Chia sẻ ")],-1))])])]))),128))])),s("div",fs,[s("button",{class:"btn btn-secondary",disabled:r.currentPage===1,onClick:t[0]||(t[0]=(...e)=>o.goToFirstPage&&o.goToFirstPage(...e))},t[8]||(t[8]=[s("i",{class:"fa-solid fa-backward-step"},null,-1)]),8,bs),s("button",{class:"btn btn-secondary mx-2",disabled:r.currentPage===1,onClick:t[1]||(t[1]=(...e)=>o.goToPreviousPage&&o.goToPreviousPage(...e))},t[9]||(t[9]=[s("i",{class:"fa-solid fa-backward"},null,-1)]),8,vs),(n(!0),l(v,null,y(o.totalPages,e=>(n(),l("button",{key:e,class:x(["btn",e===r.currentPage?"btn-primary":"btn-secondary"]),onClick:c=>r.currentPage=e},d(e),11,ys))),128)),s("button",{class:"btn btn-secondary mx-2",disabled:r.currentPage===o.totalPages,onClick:t[2]||(t[2]=(...e)=>o.goToNextPage&&o.goToNextPage(...e))},t[10]||(t[10]=[s("i",{class:"fa-solid fa-forward"},null,-1)]),8,_s),s("button",{class:"btn btn-secondary",disabled:r.currentPage===o.totalPages,onClick:t[3]||(t[3]=(...e)=>o.goToLastPage&&o.goToLastPage(...e))},t[11]||(t[11]=[s("i",{class:"fa-solid fa-forward-step"},null,-1)]),8,ks)])])}const Ps=_(is,[["render",ws],["__scopeId","data-v-b6a4ce66"]]),xs="http://localhost:8080/ASM_KiNangLamViec/users_api",Ls={data(){return{idoremail:"",password:"",errorMessage:"",isLoading:!1}},methods:{async login(){var i,t,a;if(this.errorMessage="",!this.idoremail||!this.password){this.errorMessage="Vui lòng nhập đầy đủ thông tin!";return}this.isLoading=!0;try{const u=await f.put(xs,{email:this.idoremail,password:this.password}),{id:r,email:o,fullname:e,admin:c}=u.data;sessionStorage.setItem("user",JSON.stringify({id:r,email:o,fullname:e,isAdmin:c})),sessionStorage.setItem("isAuthenticated","true"),this.$router.push("/"),window.location.href="/"}catch(u){this.errorMessage=((i=u.response)==null?void 0:i.status)===401?"Sai ID/Email hoặc mật khẩu.":((a=(t=u.response)==null?void 0:t.data)==null?void 0:a.message)||"Không thể kết nối đến máy chủ."}finally{this.isLoading=!1}}}},Fs={class:"container d-flex justify-content-center align-items-center vh-100"},Vs={class:"card p-4 shadow-lg border-0",style:{width:"400px"}},As={class:"form-floating mb-3"},Ms={class:"form-floating mb-3"},Is={class:"d-grid"},Ss=["disabled"],Ds={key:0,class:"spinner-border spinner-border-sm me-2"},$s={key:0,class:"alert alert-danger mt-3",role:"alert"},Us={class:"text-center mt-3"},Ts={class:"text-muted"};function Cs(i,t,a,u,r,o){const e=L("router-link");return n(),l("div",Fs,[s("div",Vs,[t[8]||(t[8]=s("h3",{class:"text-center mb-4"},"Đăng nhập",-1)),s("form",{onSubmit:t[2]||(t[2]=w((...c)=>o.login&&o.login(...c),["prevent"]))},[s("div",As,[h(s("input",{type:"text",id:"idoremail","onUpdate:modelValue":t[0]||(t[0]=c=>r.idoremail=c),class:"form-control",placeholder:"Nhập ID hoặc Email",required:""},null,512),[[g,r.idoremail,void 0,{trim:!0}]]),t[3]||(t[3]=s("label",{for:"idoremail"},"ID hoặc Email",-1))]),s("div",Ms,[h(s("input",{type:"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=c=>r.password=c),class:"form-control",placeholder:"Nhập mật khẩu",required:""},null,512),[[g,r.password,void 0,{trim:!0}]]),t[4]||(t[4]=s("label",{for:"password"},"Mật khẩu",-1))]),s("div",Is,[s("button",{type:"submit",class:"btn btn-primary",disabled:r.isLoading},[r.isLoading?(n(),l("span",Ds)):p("",!0),t[5]||(t[5]=m(" Đăng nhập "))],8,Ss)])],32),r.errorMessage?(n(),l("div",$s,d(r.errorMessage),1)):p("",!0),s("div",Us,[s("p",Ts,[t[7]||(t[7]=m(" Bạn chưa có tài khoản? ")),b(e,{to:"/sign_up",class:"text-primary text-decoration-none"},{default:k(()=>t[6]||(t[6]=[m(" Đăng ký ngay ")])),_:1})])])])])}const qs=_(Ls,[["render",Cs],["__scopeId","data-v-e9974a40"]]),Ns="http://localhost:8082/ASM_Java4/users_api",Es={data(){return{formData:{id:"",fullname:"",email:"",password:"",confirmPassword:""},errorMessage:"",isLoading:!1}},methods:{async submitForm(){var i,t;if(this.errorMessage="",this.formData.password!==this.formData.confirmPassword){this.errorMessage="Mật khẩu và xác nhận mật khẩu không khớp.";return}this.isLoading=!0;try{const a=await f.post(Ns,this.formData);a.status===201||a.status===200?(alert("Đăng ký thành công!"),this.$router.push("/login")):this.errorMessage="Đăng ký thất bại, vui lòng thử lại."}catch(a){this.errorMessage=((t=(i=a.response)==null?void 0:i.data)==null?void 0:t.message)||"Có lỗi xảy ra, vui lòng thử lại."}finally{this.isLoading=!1}}}},Rs={class:"container d-flex justify-content-center align-items-center vh-100"},Ks={class:"card p-4 shadow-lg border-0",style:{width:"400px"}},Os={class:"form-floating mb-3"},Qs={class:"form-floating mb-3"},Bs={class:"form-floating mb-3"},Js={class:"form-floating mb-3"},js={class:"form-floating mb-3"},Xs={class:"d-grid"},Hs=["disabled"],Gs={key:0,class:"spinner-border spinner-border-sm me-2"},zs={key:0,class:"alert alert-danger mt-3",role:"alert"},Ys={class:"text-center mt-3"},Ws={class:"text-muted"};function Zs(i,t,a,u,r,o){const e=L("router-link");return n(),l("div",Rs,[s("div",Ks,[t[14]||(t[14]=s("h3",{class:"text-center mb-4"},"Đăng ký",-1)),s("form",{onSubmit:t[5]||(t[5]=w((...c)=>o.submitForm&&o.submitForm(...c),["prevent"]))},[s("div",Os,[h(s("input",{type:"text",id:"id","onUpdate:modelValue":t[0]||(t[0]=c=>r.formData.id=c),class:"form-control",placeholder:"Nhập ID",required:""},null,512),[[g,r.formData.id,void 0,{trim:!0}]]),t[6]||(t[6]=s("label",{for:"id"},"ID",-1))]),s("div",Qs,[h(s("input",{type:"text",id:"fullname","onUpdate:modelValue":t[1]||(t[1]=c=>r.formData.fullname=c),class:"form-control",placeholder:"Nhập họ và tên",required:""},null,512),[[g,r.formData.fullname,void 0,{trim:!0}]]),t[7]||(t[7]=s("label",{for:"fullname"},"Họ và tên",-1))]),s("div",Bs,[h(s("input",{type:"email",id:"email","onUpdate:modelValue":t[2]||(t[2]=c=>r.formData.email=c),class:"form-control",placeholder:"Nhập Email",required:""},null,512),[[g,r.formData.email,void 0,{trim:!0}]]),t[8]||(t[8]=s("label",{for:"email"},"Email",-1))]),s("div",Js,[h(s("input",{type:"password",id:"password","onUpdate:modelValue":t[3]||(t[3]=c=>r.formData.password=c),class:"form-control",placeholder:"Nhập mật khẩu",required:""},null,512),[[g,r.formData.password,void 0,{trim:!0}]]),t[9]||(t[9]=s("label",{for:"password"},"Mật khẩu",-1))]),s("div",js,[h(s("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":t[4]||(t[4]=c=>r.formData.confirmPassword=c),class:"form-control",placeholder:"Xác nhận mật khẩu",required:""},null,512),[[g,r.formData.confirmPassword,void 0,{trim:!0}]]),t[10]||(t[10]=s("label",{for:"confirmPassword"},"Xác nhận mật khẩu",-1))]),s("div",Xs,[s("button",{type:"submit",class:"btn btn-primary",disabled:r.isLoading},[r.isLoading?(n(),l("span",Gs)):p("",!0),t[11]||(t[11]=m(" Đăng ký "))],8,Hs)])],32),r.errorMessage?(n(),l("div",zs,d(r.errorMessage),1)):p("",!0),s("div",Ys,[s("p",Ws,[t[13]||(t[13]=m(" Bạn đã có tài khoản? ")),b(e,{to:"/login",class:"text-primary text-decoration-none"},{default:k(()=>t[12]||(t[12]=[m(" Đăng nhập ngay ")])),_:1})])])])])}const te=_(Es,[["render",Zs],["__scopeId","data-v-c136c6d6"]]),se="http://localhost:8082/ASM_Java4/users_api",ee={data(){return{formData:{id:"",fullname:"",email:"",password:""},errorMessage:"",isLoading:!1}},methods:{async fetchUserData(){const i=JSON.parse(sessionStorage.getItem("user"));if(!i){alert("Bạn cần đăng nhập để sử dụng chức năng này!"),this.$router.push("/login");return}this.formData={id:i.id,fullname:i.fullname,email:i.email,password:""}},async submitForm(){var i,t;if(this.errorMessage="",!this.formData.fullname||!this.formData.email){this.errorMessage="Họ và tên, Email không được để trống!";return}this.isLoading=!0;try{(await f.put(`${se}/${this.formData.id}`,this.formData)).status===200?(alert("Cập nhật thông tin thành công!"),sessionStorage.setItem("user",JSON.stringify({id:this.formData.id,fullname:this.formData.fullname,email:this.formData.email})),this.$router.push("/")):this.errorMessage="Không thể cập nhật thông tin. Vui lòng thử lại."}catch(a){this.errorMessage=((t=(i=a.response)==null?void 0:i.data)==null?void 0:t.message)||"Có lỗi xảy ra, vui lòng thử lại."}finally{this.isLoading=!1}},goBack(){this.$router.push("/")}},mounted(){this.fetchUserData()}},re={class:"container d-flex justify-content-center align-items-center vh-100"},ie={class:"card p-4 shadow-lg border-0",style:{width:"400px"}},oe={class:"form-floating mb-3"},ne={class:"form-floating mb-3"},le={class:"form-floating mb-3"},ae={class:"d-grid"},de=["disabled"],ue={key:0,class:"spinner-border spinner-border-sm me-2"},ce={key:0,class:"alert alert-danger mt-3",role:"alert"},me={class:"text-center mt-3"};function he(i,t,a,u,r,o){return n(),l("div",re,[s("div",ie,[t[9]||(t[9]=s("h3",{class:"text-center mb-4"},"Chỉnh sửa thông tin",-1)),s("form",{onSubmit:t[3]||(t[3]=w((...e)=>o.submitForm&&o.submitForm(...e),["prevent"]))},[s("div",oe,[h(s("input",{type:"text",id:"id","onUpdate:modelValue":t[0]||(t[0]=e=>r.formData.id=e),class:"form-control",placeholder:"Nhập ID",readonly:""},null,512),[[g,r.formData.id,void 0,{trim:!0}]]),t[5]||(t[5]=s("label",{for:"id"},"ID",-1))]),s("div",ne,[h(s("input",{type:"text",id:"fullname","onUpdate:modelValue":t[1]||(t[1]=e=>r.formData.fullname=e),class:"form-control",placeholder:"Nhập họ và tên",required:""},null,512),[[g,r.formData.fullname,void 0,{trim:!0}]]),t[6]||(t[6]=s("label",{for:"fullname"},"Họ và tên",-1))]),s("div",le,[h(s("input",{type:"email",id:"email","onUpdate:modelValue":t[2]||(t[2]=e=>r.formData.email=e),class:"form-control",placeholder:"Nhập Email",required:""},null,512),[[g,r.formData.email,void 0,{trim:!0}]]),t[7]||(t[7]=s("label",{for:"email"},"Email",-1))]),s("div",ae,[s("button",{type:"submit",class:"btn btn-primary",disabled:r.isLoading},[r.isLoading?(n(),l("span",ue)):p("",!0),t[8]||(t[8]=m(" Lưu thay đổi "))],8,de)])],32),r.errorMessage?(n(),l("div",ce,d(r.errorMessage),1)):p("",!0),s("div",me,[s("button",{onClick:t[4]||(t[4]=(...e)=>o.goBack&&o.goBack(...e)),class:"btn btn-outline-secondary"}," Quay lại ")])])])}const pe=_(ee,[["render",he],["__scopeId","data-v-860755c0"]]),ge="http://localhost:8082/ASM_Java4/users_api",fe={data(){return{currentPassword:"",newPassword:"",confirmPassword:"",errorMessage:"",successMessage:"",isLoading:!1}},methods:{async changePassword(){var i,t,a;if(this.errorMessage="",this.successMessage="",!this.currentPassword||!this.newPassword||!this.confirmPassword){this.errorMessage="Vui lòng điền đầy đủ thông tin!";return}if(this.newPassword!==this.confirmPassword){this.errorMessage="Mật khẩu mới và xác nhận mật khẩu không khớp!";return}if(this.newPassword.length<6){this.errorMessage="Mật khẩu mới phải có ít nhất 6 ký tự!";return}this.isLoading=!0;try{const u=JSON.parse(sessionStorage.getItem("user"));if(!u){this.errorMessage="Bạn cần đăng nhập để đổi mật khẩu!",this.$router.push("/login");return}const r=await f.put(`${ge}/${u.id}`,{id:u.id,password:this.newPassword,currentPassword:this.currentPassword});r.status===200?(this.successMessage="Đổi mật khẩu thành công!",this.currentPassword="",this.newPassword="",this.confirmPassword=""):this.errorMessage=((i=r.data)==null?void 0:i.error)||"Không thể đổi mật khẩu. Vui lòng thử lại."}catch(u){this.errorMessage=((a=(t=u.response)==null?void 0:t.data)==null?void 0:a.error)||"Không thể kết nối đến máy chủ."}finally{this.isLoading=!1}}}},be={class:"container d-flex justify-content-center align-items-center vh-100"},ve={class:"card p-4 shadow-lg border-0",style:{width:"400px"}},ye={class:"form-floating mb-3"},_e={class:"form-floating mb-3"},ke={class:"form-floating mb-3"},we={class:"d-grid"},Pe=["disabled"],xe={key:0,class:"spinner-border spinner-border-sm me-2"},Le={key:0,class:"alert alert-danger mt-3",role:"alert"},Fe={key:1,class:"alert alert-success mt-3",role:"alert"};function Ve(i,t,a,u,r,o){return n(),l("div",be,[s("div",ve,[t[8]||(t[8]=s("h3",{class:"text-center mb-4"},"Đổi mật khẩu",-1)),s("form",{onSubmit:t[3]||(t[3]=w((...e)=>o.changePassword&&o.changePassword(...e),["prevent"]))},[s("div",ye,[h(s("input",{type:"password",id:"currentPassword","onUpdate:modelValue":t[0]||(t[0]=e=>r.currentPassword=e),class:"form-control",placeholder:"Nhập mật khẩu hiện tại",required:""},null,512),[[g,r.currentPassword,void 0,{trim:!0}]]),t[4]||(t[4]=s("label",{for:"currentPassword"},"Mật khẩu hiện tại",-1))]),s("div",_e,[h(s("input",{type:"password",id:"newPassword","onUpdate:modelValue":t[1]||(t[1]=e=>r.newPassword=e),class:"form-control",placeholder:"Nhập mật khẩu mới",required:""},null,512),[[g,r.newPassword,void 0,{trim:!0}]]),t[5]||(t[5]=s("label",{for:"newPassword"},"Mật khẩu mới",-1))]),s("div",ke,[h(s("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":t[2]||(t[2]=e=>r.confirmPassword=e),class:"form-control",placeholder:"Xác nhận mật khẩu mới",required:""},null,512),[[g,r.confirmPassword,void 0,{trim:!0}]]),t[6]||(t[6]=s("label",{for:"confirmPassword"},"Xác nhận mật khẩu mới",-1))]),s("div",we,[s("button",{type:"submit",class:"btn btn-primary",disabled:r.isLoading},[r.isLoading?(n(),l("span",xe)):p("",!0),t[7]||(t[7]=m(" Đổi mật khẩu "))],8,Pe)])],32),r.errorMessage?(n(),l("div",Le,d(r.errorMessage),1)):p("",!0),r.successMessage?(n(),l("div",Fe,d(r.successMessage),1)):p("",!0)])])}const Ae=_(fe,[["render",Ve],["__scopeId","data-v-66a473f2"]]),Me="http://localhost:8082/ASM_Java4/forgot_password_api",Ie={data(){return{email:"",resetCode:"",newPassword:"",confirmPassword:"",resetStep:!1,errorMessage:"",successMessage:"",isLoading:!1}},methods:{async requestReset(){var i,t,a;if(this.errorMessage="",this.successMessage="",!this.email){this.errorMessage="Vui lòng nhập email.";return}this.isLoading=!0;try{const u=await f.post("http://localhost:8082/ASM_Java4/forgot_password_api/request",{email:this.email});u.status===200?(this.successMessage="Mã xác nhận đã được gửi đến email của bạn.",this.resetStep=!0):this.errorMessage=((i=u.data)==null?void 0:i.error)||"Không thể gửi mã xác nhận."}catch(u){this.errorMessage=((a=(t=u.response)==null?void 0:t.data)==null?void 0:a.error)||"Không thể kết nối đến máy chủ."}finally{this.isLoading=!1}},async resetPassword(){var i,t,a;if(this.errorMessage="",this.successMessage="",!this.resetCode||!this.newPassword||!this.confirmPassword){this.errorMessage="Vui lòng điền đầy đủ thông tin.";return}if(this.newPassword!==this.confirmPassword){this.errorMessage="Mật khẩu mới và xác nhận mật khẩu không khớp.";return}if(this.newPassword.length<6){this.errorMessage="Mật khẩu mới phải có ít nhất 6 ký tự.";return}this.isLoading=!0;try{const u=await f.put(`${Me}/reset`,{resetCode:this.resetCode,newPassword:this.newPassword});u.status===200?(this.successMessage="Đặt lại mật khẩu thành công!",this.resetStep=!1,this.email=""):this.errorMessage=((i=u.data)==null?void 0:i.error)||"Không thể đặt lại mật khẩu."}catch(u){this.errorMessage=((a=(t=u.response)==null?void 0:t.data)==null?void 0:a.error)||"Không thể kết nối đến máy chủ."}finally{this.isLoading=!1}}}},Se={class:"container d-flex justify-content-center align-items-center vh-100"},De={class:"card p-4 shadow-lg border-0",style:{width:"400px"}},$e={key:0},Ue={class:"form-floating mb-3"},Te={class:"d-grid"},Ce=["disabled"],qe={key:0,class:"spinner-border spinner-border-sm me-2"},Ne={key:0,class:"alert alert-danger mt-3",role:"alert"},Ee={key:1,class:"alert alert-success mt-3",role:"alert"},Re={key:1},Ke={class:"form-floating mb-3"},Oe={class:"form-floating mb-3"},Qe={class:"form-floating mb-3"},Be={class:"d-grid"},Je=["disabled"],je={key:0,class:"spinner-border spinner-border-sm me-2"},Xe={key:0,class:"alert alert-danger mt-3",role:"alert"},He={key:1,class:"alert alert-success mt-3",role:"alert"};function Ge(i,t,a,u,r,o){return n(),l("div",Se,[s("div",De,[t[12]||(t[12]=s("h3",{class:"text-center mb-4"},"Quên mật khẩu",-1)),r.resetStep?(n(),l("div",Re,[s("form",{onSubmit:t[5]||(t[5]=w((...e)=>o.resetPassword&&o.resetPassword(...e),["prevent"]))},[s("div",Ke,[h(s("input",{type:"text",id:"resetCode","onUpdate:modelValue":t[2]||(t[2]=e=>r.resetCode=e),class:"form-control",placeholder:"Nhập mã xác nhận",required:""},null,512),[[g,r.resetCode,void 0,{trim:!0}]]),t[8]||(t[8]=s("label",{for:"resetCode"},"Mã xác nhận",-1))]),s("div",Oe,[h(s("input",{type:"password",id:"newPassword","onUpdate:modelValue":t[3]||(t[3]=e=>r.newPassword=e),class:"form-control",placeholder:"Nhập mật khẩu mới",required:""},null,512),[[g,r.newPassword,void 0,{trim:!0}]]),t[9]||(t[9]=s("label",{for:"newPassword"},"Mật khẩu mới",-1))]),s("div",Qe,[h(s("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":t[4]||(t[4]=e=>r.confirmPassword=e),class:"form-control",placeholder:"Xác nhận mật khẩu mới",required:""},null,512),[[g,r.confirmPassword,void 0,{trim:!0}]]),t[10]||(t[10]=s("label",{for:"confirmPassword"},"Xác nhận mật khẩu mới",-1))]),s("div",Be,[s("button",{type:"submit",class:"btn btn-primary",disabled:r.isLoading},[r.isLoading?(n(),l("span",je)):p("",!0),t[11]||(t[11]=m(" Đặt lại mật khẩu "))],8,Je)])],32),r.errorMessage?(n(),l("div",Xe,d(r.errorMessage),1)):p("",!0),r.successMessage?(n(),l("div",He,d(r.successMessage),1)):p("",!0)])):(n(),l("div",$e,[s("form",{onSubmit:t[1]||(t[1]=w((...e)=>o.requestReset&&o.requestReset(...e),["prevent"]))},[s("div",Ue,[h(s("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>r.email=e),class:"form-control",placeholder:"Nhập email của bạn",required:""},null,512),[[g,r.email,void 0,{trim:!0}]]),t[6]||(t[6]=s("label",{for:"email"},"Email",-1))]),s("div",Te,[s("button",{type:"submit",class:"btn btn-primary",disabled:r.isLoading},[r.isLoading?(n(),l("span",qe)):p("",!0),t[7]||(t[7]=m(" Gửi mã xác nhận "))],8,Ce)])],32),r.errorMessage?(n(),l("div",Ne,d(r.errorMessage),1)):p("",!0),r.successMessage?(n(),l("div",Ee,d(r.successMessage),1)):p("",!0)]))])])}const ze=_(Ie,[["render",Ge],["__scopeId","data-v-a8ffa9bd"]]),F="http://localhost:8082/ASM_Java4/quanliuser_api",Ye={data(){return{userForm:{id:"",password:"",fullname:"",email:"",admin:!1,active:!0},userList:[]}},methods:{async fetchUserList(){try{const i=await f.get(F);i.status===200&&(this.userList=i.data,console.log("Danh sách người dùng:",this.userList))}catch(i){console.error("Lỗi khi tải danh sách người dùng:",i),alert("Không thể tải danh sách người dùng. Vui lòng thử lại.")}},editUser(i){this.userForm={...i};const t=document.getElementById("user-edition-tab");t&&t.click()},async updateUser(){var i,t;try{const a=await f.put(F,this.userForm);alert(a.data.message||"Cập nhật thông tin thành công."),this.fetchUserList(),this.resetForm()}catch(a){console.error("Lỗi khi cập nhật người dùng:",a),alert(((t=(i=a.response)==null?void 0:i.data)==null?void 0:t.error)||"Không thể cập nhật thông tin.")}},async deleteUser(i){if(confirm("Bạn có chắc chắn muốn xóa người dùng này?"))try{await f.delete(`${F}/${i}`),alert("Xóa người dùng thành công."),this.fetchUserList()}catch(t){console.error("Lỗi khi xóa người dùng:",t),alert("Không thể xóa người dùng. Vui lòng thử lại.")}},resetForm(){this.userForm={id:"",password:"",fullname:"",email:"",admin:!1,active:!0},this.posterFile=null}},mounted(){this.fetchUserList()}},We={class:"container mt-5"},Ze={class:"tab-content mt-3"},tr={class:"tab-pane fade show active",id:"user-edition",role:"tabpanel","aria-labelledby":"user-edition-tab"},sr={class:"card"},er={class:"card-body"},rr={class:"mb-3"},ir={class:"mb-3"},or={class:"mb-3"},nr={class:"mb-3"},lr={class:"mb-3"},ar={class:"tab-pane fade",id:"user-list",role:"tabpanel","aria-labelledby":"user-list-tab"},dr={class:"card"},ur={class:"card-body"},cr={class:"table table-bordered user-list"},mr=["onClick"],hr=["onClick"],pr={key:0,class:"text-center mt-3"};function gr(i,t,a,u,r,o){return n(),l("div",We,[t[18]||(t[18]=s("ul",{class:"nav nav-tabs",id:"myTab",role:"tablist"},[s("li",{class:"nav-item",role:"presentation"},[s("button",{class:"nav-link active",id:"user-edition-tab","data-bs-toggle":"tab","data-bs-target":"#user-edition",type:"button",role:"tab","aria-controls":"user-edition","aria-selected":"true"}," User Edition ")]),s("li",{class:"nav-item",role:"presentation"},[s("button",{class:"nav-link",id:"user-list-tab","data-bs-toggle":"tab","data-bs-target":"#user-list",type:"button",role:"tab","aria-controls":"user-list","aria-selected":"false"}," User List ")])],-1)),s("div",Ze,[s("div",tr,[s("div",sr,[t[12]||(t[12]=s("div",{class:"card-header"},"User Information",-1)),s("div",er,[s("form",{onSubmit:t[5]||(t[5]=w((...e)=>o.updateUser&&o.updateUser(...e),["prevent"]))},[s("div",rr,[t[6]||(t[6]=s("label",{for:"id",class:"form-label"},"Username:",-1)),h(s("input",{type:"text",id:"id","onUpdate:modelValue":t[0]||(t[0]=e=>r.userForm.id=e),class:"form-control",required:""},null,512),[[g,r.userForm.id]])]),s("div",ir,[t[7]||(t[7]=s("label",{for:"password",class:"form-label"},"Password:",-1)),h(s("input",{type:"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>r.userForm.password=e),class:"form-control"},null,512),[[g,r.userForm.password]])]),s("div",or,[t[8]||(t[8]=s("label",{for:"fullname",class:"form-label"},"Fullname:",-1)),h(s("input",{type:"text",id:"fullname","onUpdate:modelValue":t[2]||(t[2]=e=>r.userForm.fullname=e),class:"form-control",required:""},null,512),[[g,r.userForm.fullname]])]),s("div",nr,[t[9]||(t[9]=s("label",{for:"email",class:"form-label"},"Email:",-1)),h(s("input",{type:"email",id:"email","onUpdate:modelValue":t[3]||(t[3]=e=>r.userForm.email=e),class:"form-control",required:""},null,512),[[g,r.userForm.email]])]),s("div",lr,[t[10]||(t[10]=s("label",{for:"admin",class:"form-label"},"Admin:",-1)),h(s("input",{type:"checkbox",id:"admin","onUpdate:modelValue":t[4]||(t[4]=e=>r.userForm.admin=e),class:"form-check-input"},null,512),[[$,r.userForm.admin]])]),t[11]||(t[11]=s("div",{class:"text-center"},[s("button",{class:"btn btn-primary me-2 btn-custom",type:"submit"}," Update ")],-1))],32)])])]),s("div",ar,[s("div",dr,[t[17]||(t[17]=s("div",{class:"card-header"},"User List",-1)),s("div",ur,[s("table",cr,[t[15]||(t[15]=s("thead",null,[s("tr",null,[s("th",null,"Username"),s("th",null,"Password"),s("th",null,"Fullname"),s("th",null,"Email"),s("th",null,"Role"),s("th",null,"Actions")])],-1)),s("tbody",null,[(n(!0),l(v,null,y(r.userList,e=>(n(),l("tr",{key:e.id},[s("td",null,d(e.id),1),s("td",null,d(e.password),1),s("td",null,d(e.fullname),1),s("td",null,d(e.email),1),s("td",null,d(e.admin?"Admin":"User"),1),s("td",null,[s("button",{class:"btn btn-link text-primary",onClick:c=>o.editUser(e)},t[13]||(t[13]=[s("i",{class:"fa-regular fa-pen-to-square"},null,-1)]),8,mr),s("button",{class:"btn btn-link text-danger",onClick:c=>o.deleteUser(e.id)},t[14]||(t[14]=[s("i",{class:"fas fa-trash-alt"},null,-1)]),8,hr)])]))),128))])]),r.userList.length===0?(n(),l("div",pr,t[16]||(t[16]=[s("p",null,"Không có người dùng nào được tìm thấy.",-1)]))):p("",!0)])])])])])}const fr=_(Ye,[["render",gr],["__scopeId","data-v-3022e595"]]),P="http://localhost:8082/ASM_Java4/quanlivideo_api",D="http://localhost:8082/ASM_Java4/upload_poster",br={data(){return{videoList:[],videoForm:{id:"",title:"",poster:"",link:"",description:"",views:0,active:!0},posterFile:null}},methods:{async fetchVideos(){try{const i=await f.get(P);this.videoList=i.data}catch{alert("Lỗi khi tải danh sách video. Vui lòng thử lại.")}},handleFileUpload(i){const t=i.target.files[0];t&&(this.posterFile=t,this.videoForm.poster=t.name)},async createVideo(){try{if(this.posterFile){const i=new FormData;i.append("file",this.posterFile);const t=await f.post(D,i);this.videoForm.poster=t.data.filePath}await f.post(P,this.videoForm),alert("Thêm tiểu phẩm thành công!"),this.fetchVideos(),this.resetForm()}catch{alert("Không thể thêm tiểu phẩm. Vui lòng thử lại.")}},async updateVideo(){try{if(this.posterFile){const i=new FormData;i.append("file",this.posterFile);const t=await f.post(D,i);this.videoForm.poster=t.data.filePath}await f.put(`${P}/${this.videoForm.id}`,this.videoForm),console.log(this.videoForm.id),alert("Cập nhật tiểu phẩm thành công!"),await this.fetchVideos(),this.resetForm()}catch{alert("Không thể cập nhật tiểu phẩm. Vui lòng thử lại.")}},async deleteVideo(i){if(confirm("Bạn có chắc chắn muốn xóa tiểu phẩm này?"))try{await f.delete(`${P}/${i}`),alert("Xóa tiểu phẩm thành công!"),this.fetchVideos()}catch{alert("Không thể xóa tiểu phẩm. Vui lòng thử lại.")}},editVideo(i){this.videoForm={...i},document.getElementById("video-edit-tab").click()},resetForm(){this.videoForm={id:"",title:"",poster:"",link:"",description:"",views:0,active:!0},this.posterFile=null},getImagePath(i){return i?`/img/${i}`:"/img/default-poster.jpg"}},mounted(){this.fetchVideos()}},vr={class:"container mt-5"},yr={class:"tab-content mt-3"},_r={class:"tab-pane fade show active",id:"video-edit",role:"tabpanel","aria-labelledby":"video-edit-tab"},kr={class:"card"},wr={class:"card-body"},Pr={class:"mb-3"},xr={class:"mb-3"},Lr={class:"mb-3"},Fr={key:0,class:"mt-2"},Vr={class:"text-muted"},Ar={class:"mb-3"},Mr={class:"mb-3"},Ir={class:"mb-3"},Sr={class:"mb-3"},Dr={class:"text-center"},$r={class:"tab-pane fade",id:"video-list",role:"tabpanel","aria-labelledby":"video-list-tab"},Ur={class:"card"},Tr={class:"card-body"},Cr={class:"table table-bordered"},qr=["src","alt"],Nr=["href"],Er=["onClick"],Rr=["onClick"],Kr={key:0,class:"text-center mt-3"};function Or(i,t,a,u,r,o){return n(),l("div",vr,[t[24]||(t[24]=s("ul",{class:"nav nav-tabs",id:"myTab",role:"tablist"},[s("li",{class:"nav-item",role:"presentation"},[s("button",{class:"nav-link active",id:"video-edit-tab","data-bs-toggle":"tab","data-bs-target":"#video-edit",type:"button",role:"tab","aria-controls":"video-edit","aria-selected":"true"}," Thêm/Sửa Tiểu Phẩm ")]),s("li",{class:"nav-item",role:"presentation"},[s("button",{class:"nav-link",id:"video-list-tab","data-bs-toggle":"tab","data-bs-target":"#video-list",type:"button",role:"tab","aria-controls":"video-list","aria-selected":"false"}," Danh Sách Tiểu Phẩm ")])],-1)),s("div",yr,[s("div",_r,[s("div",kr,[t[18]||(t[18]=s("div",{class:"card-header"},"Thêm/Sửa Tiểu Phẩm",-1)),s("div",wr,[s("form",{onSubmit:t[10]||(t[10]=w((...e)=>i.saveVideo&&i.saveVideo(...e),["prevent"]))},[s("div",Pr,[t[11]||(t[11]=s("label",{for:"id",class:"form-label"},"ID:",-1)),h(s("input",{type:"text",id:"id","onUpdate:modelValue":t[0]||(t[0]=e=>r.videoForm.id=e),class:"form-control",required:""},null,512),[[g,r.videoForm.id]])]),s("div",xr,[t[12]||(t[12]=s("label",{for:"title",class:"form-label"},"Tiêu Đề:",-1)),h(s("input",{type:"text",id:"title","onUpdate:modelValue":t[1]||(t[1]=e=>r.videoForm.title=e),class:"form-control",required:""},null,512),[[g,r.videoForm.title]])]),s("div",Lr,[t[13]||(t[13]=s("label",{for:"poster",class:"form-label"},"Ảnh Bìa:",-1)),s("input",{type:"file",id:"poster",onChange:t[2]||(t[2]=(...e)=>o.handleFileUpload&&o.handleFileUpload(...e)),class:"form-control"},null,32),r.videoForm.poster?(n(),l("div",Fr,[s("small",Vr,"File đã chọn: "+d(r.videoForm.poster),1)])):p("",!0)]),s("div",Ar,[t[14]||(t[14]=s("label",{for:"link",class:"form-label"},"Link Video:",-1)),h(s("input",{type:"text",id:"link","onUpdate:modelValue":t[3]||(t[3]=e=>r.videoForm.link=e),class:"form-control",required:""},null,512),[[g,r.videoForm.link]])]),s("div",Mr,[t[15]||(t[15]=s("label",{for:"description",class:"form-label"},"Mô Tả:",-1)),h(s("textarea",{id:"description","onUpdate:modelValue":t[4]||(t[4]=e=>r.videoForm.description=e),class:"form-control",required:""},null,512),[[g,r.videoForm.description]])]),s("div",Ir,[t[16]||(t[16]=s("label",{for:"views",class:"form-label"},"Lượt Xem:",-1)),h(s("input",{type:"number",id:"views","onUpdate:modelValue":t[5]||(t[5]=e=>r.videoForm.views=e),class:"form-control",required:""},null,512),[[g,r.videoForm.views]])]),s("div",Sr,[t[17]||(t[17]=s("label",{for:"active",class:"form-label"},"Kích Hoạt:",-1)),h(s("input",{type:"checkbox",id:"active","onUpdate:modelValue":t[6]||(t[6]=e=>r.videoForm.active=e),class:"form-check-input"},null,512),[[$,r.videoForm.active]])]),s("div",Dr,[s("button",{class:"btn btn-success me-2",type:"button",onClick:t[7]||(t[7]=(...e)=>o.createVideo&&o.createVideo(...e))}," Thêm "),s("button",{class:"btn btn-primary me-2",type:"button",onClick:t[8]||(t[8]=(...e)=>o.updateVideo&&o.updateVideo(...e))}," Cập Nhật "),s("button",{class:"btn btn-secondary",type:"button",onClick:t[9]||(t[9]=(...e)=>o.resetForm&&o.resetForm(...e))}," Đặt Lại ")])],32)])])]),s("div",$r,[s("div",Ur,[t[23]||(t[23]=s("div",{class:"card-header"},"Danh Sách Tiểu Phẩm",-1)),s("div",Tr,[s("table",Cr,[t[21]||(t[21]=s("thead",null,[s("tr",null,[s("th",null,"Id"),s("th",null,"Poster"),s("th",null,"Tiêu Đề"),s("th",null,"Lượt Xem"),s("th",null,"Link"),s("th",null,"Active"),s("th",null,"Hành Động")])],-1)),s("tbody",null,[(n(!0),l(v,null,y(r.videoList,e=>(n(),l("tr",{key:e.id},[s("td",null,d(e.id),1),s("td",null,[s("img",{src:o.getImagePath(e.poster),class:"card-img-top rounded",alt:e.title},null,8,qr)]),s("td",null,d(e.title),1),s("td",null,d(e.views),1),s("td",null,[s("a",{href:e.link,target:"_blank"},"Xem",8,Nr)]),s("td",null,d(e.active?"Đang Kích Hoạt":"Chưa Kích Hoạt"),1),s("td",null,[s("button",{class:"btn btn-link text-primary",onClick:c=>o.editVideo(e)},t[19]||(t[19]=[s("i",{class:"fa-regular fa-pen-to-square"},null,-1)]),8,Er),s("button",{class:"btn btn-link text-danger",onClick:c=>o.deleteVideo(e.id)},t[20]||(t[20]=[s("i",{class:"fas fa-trash-alt"},null,-1)]),8,Rr)])]))),128))])]),r.videoList.length===0?(n(),l("div",Kr,t[22]||(t[22]=[s("p",null,"Không có tiểu phẩm nào được tìm thấy.",-1)]))):p("",!0)])])])])])}const Qr=_(br,[["render",Or],["__scopeId","data-v-271894c4"]]),Br={data(){return{listFavorite:[],listFavoriteUser:[],listShared:[],selectedVideoFilter:"",selectedSharedFilter:"",filterOptions:[]}},methods:{async fetchFavorites(){try{const i=await f.get("http://localhost:8082/ASM_Java4/report_api");this.listFavorite=i.data.map(t=>({videoTitle:t.videoTitle,favoriteCount:t.favoriteCount,newestDate:t.newestDate,oldestDate:t.oldestDate}))}catch{alert("Failed to fetch favorite stats.")}},async fetchFavoriteUsers(){try{const i=await f.get(`http://localhost:8082/report_api?filter=likedUsers&videoId=${this.selectedVideoFilter}`);this.listFavoriteUser=i.data}catch{alert("Failed to fetch favorite users.")}},async fetchSharedFriends(){try{const i=await f.get(`http://localhost:8082/report_api?filter=sharedUsers&videoId=${this.selectedSharedFilter}`);this.listShared=i.data}catch{alert("Failed to fetch shared friends.")}}},mounted(){this.fetchFavorites()}},Jr={class:"container mt-5"},jr={class:"tab-content mt-3",id:"myTabContent"},Xr={class:"tab-pane fade show active",id:"favorites",role:"tabpanel","aria-labelledby":"favorites-tab"},Hr={class:"card"},Gr={class:"card-body"},zr={class:"table table-bordered video-list"},Yr={class:"tab-pane fade",id:"favorite-users",role:"tabpanel","aria-labelledby":"favorite-users-tab"},Wr={class:"card"},Zr={class:"card-body"},ti={class:"d-flex justify-content-between mb-3"},si=["value"],ei={class:"table table-bordered video-list"},ri={class:"tab-pane fade",id:"shared-friends",role:"tabpanel","aria-labelledby":"shared-friends-tab"},ii={class:"card"},oi={class:"card-body"},ni={class:"d-flex justify-content-between mb-3"},li=["value"],ai={class:"table table-bordered video-list"};function di(i,t,a,u,r,o){return n(),l("div",Jr,[t[14]||(t[14]=s("ul",{class:"nav nav-tabs",id:"myTab",role:"tablist"},[s("li",{class:"nav-item",role:"presentation"},[s("button",{class:"nav-link active",id:"favorites-tab","data-bs-toggle":"tab","data-bs-target":"#favorites",type:"button",role:"tab","aria-controls":"favorites","aria-selected":"true"}," FAVORITES ")]),s("li",{class:"nav-item",role:"presentation"},[s("button",{class:"nav-link",id:"favorite-users-tab","data-bs-toggle":"tab","data-bs-target":"#favorite-users",type:"button",role:"tab","aria-controls":"favorite-users","aria-selected":"false"}," FAVORITE USERS ")]),s("li",{class:"nav-item",role:"presentation"},[s("button",{class:"nav-link",id:"shared-friends-tab","data-bs-toggle":"tab","data-bs-target":"#shared-friends",type:"button",role:"tab","aria-controls":"shared-friends","aria-selected":"false"}," SHARED FRIENDS ")])],-1)),s("div",jr,[s("div",Xr,[s("div",Hr,[t[5]||(t[5]=s("div",{class:"card-header"},"FAVORITES",-1)),s("div",Gr,[s("table",zr,[t[4]||(t[4]=s("thead",null,[s("tr",null,[s("th",null,"VIDEO TITLE"),s("th",null,"FAVORITE COUNT"),s("th",null,"LATEST DATE"),s("th",null,"OLDEST DATE")])],-1)),s("tbody",null,[(n(!0),l(v,null,y(r.listFavorite,(e,c)=>(n(),l("tr",{key:c},[s("td",null,d(e.videoTitle),1),s("td",null,d(e.favoriteCount),1),s("td",null,d(e.newestDate),1),s("td",null,d(e.oldestDate),1)]))),128))])])])])]),s("div",Yr,[s("div",Wr,[t[9]||(t[9]=s("div",{class:"card-header"},"FAVORITE USERS",-1)),s("div",Zr,[s("div",ti,[t[7]||(t[7]=s("label",{class:"form-label"},"VIDEO TITLE:",-1)),h(s("select",{class:"form-select","onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedVideoFilter=e),onChange:t[1]||(t[1]=(...e)=>o.fetchFavoriteUsers&&o.fetchFavoriteUsers(...e))},[t[6]||(t[6]=s("option",{value:""},"Select Filter",-1)),(n(!0),l(v,null,y(r.filterOptions,(e,c)=>(n(),l("option",{key:c,value:e.value},d(e.label),9,si))),128))],544),[[V,r.selectedVideoFilter]])]),s("table",ei,[t[8]||(t[8]=s("thead",null,[s("tr",null,[s("th",null,"USERNAME"),s("th",null,"FULLNAME"),s("th",null,"EMAIL"),s("th",null,"FAVORITE DATE")])],-1)),s("tbody",null,[(n(!0),l(v,null,y(r.listFavoriteUser,(e,c)=>(n(),l("tr",{key:c},[s("td",null,d(e.username),1),s("td",null,d(e.fullname),1),s("td",null,d(e.email),1),s("td",null,d(e.favoriteDate),1)]))),128))])])])])]),s("div",ri,[s("div",ii,[t[13]||(t[13]=s("div",{class:"card-header"},"SHARED FRIENDS",-1)),s("div",oi,[s("div",ni,[t[11]||(t[11]=s("label",{class:"form-label"},"VIDEO TITLE:",-1)),h(s("select",{class:"form-select","onUpdate:modelValue":t[2]||(t[2]=e=>r.selectedSharedFilter=e),onChange:t[3]||(t[3]=(...e)=>o.fetchSharedFriends&&o.fetchSharedFriends(...e))},[t[10]||(t[10]=s("option",{value:""},"Select Filter",-1)),(n(!0),l(v,null,y(r.filterOptions,(e,c)=>(n(),l("option",{key:c,value:e.value},d(e.label),9,li))),128))],544),[[V,r.selectedSharedFilter]])]),s("table",ai,[t[12]||(t[12]=s("thead",null,[s("tr",null,[s("th",null,"SENDER NAME"),s("th",null,"SENDER EMAIL"),s("th",null,"RECEIVER EMAIL"),s("th",null,"SENT DATE")])],-1)),s("tbody",null,[(n(!0),l(v,null,y(r.listShared,(e,c)=>(n(),l("tr",{key:c},[s("td",null,d(e.senderName),1),s("td",null,d(e.senderEmail),1),s("td",null,d(e.receiverEmail),1),s("td",null,d(e.sharedDate),1)]))),128))])])])])])])])}const ui=_(Br,[["render",di],["__scopeId","data-v-9d2bbfe5"]]),ci=[{path:"/",name:"listQuanAn",component:Ut},{path:"/QuanAnDetails/:id",name:"QuanAnDetails",component:rs},{path:"/favorites",name:"favorites",component:Ps,props:!0,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:qs},{path:"/sign_up",name:"SignUp",component:te},{path:"/edit-profile",name:"profile",component:pe,meta:{requiresAuth:!0}},{path:"/change-password",name:"changepassword",component:Ae,meta:{requiresAuth:!0}},{path:"/forgot-password",name:"forgotpassword",component:ze},{path:"/admin/users",name:"quanliuser",component:fr,meta:{requiresAuth:!0,isAdmin:!0}},{path:"/admin/videos",name:"quanlivideo",component:Qr,meta:{requiresAuth:!0,isAdmin:!0}},{path:"/admin/reports",name:"report",component:ui,meta:{requiresAuth:!0,isAdmin:!0}}],U=E({history:R("/Project_KiNangLamViec/"),routes:ci});U.beforeEach((i,t,a)=>{const u=JSON.parse(sessionStorage.getItem("user")),r=sessionStorage.getItem("isAuthenticated")==="true",o=u==null?void 0:u.isAdmin;console.log(o),i.meta.requiresAuth&&!r?a({name:"Login"}):i.meta.isAdmin&&!o?(alert("Bạn không có quyền truy cập vào trang này!"),a(!1)):a()});K(ct).use(U).mount("#app");
//# sourceMappingURL=index-CKzC5_qT.js.map
